<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>ALBAY STEPS • Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#000;color:#fff;font-family:Arial;text-align:center;margin:0;}
.container{max-width:520px;margin:auto;background:#111;padding:20px;border-radius:12px;margin-top:40px;}
input,button{width:100%;padding:12px;border:none;border-radius:6px;margin-top:10px;}
button{background:#ff0000;color:#fff;font-weight:bold;}
table{width:100%;margin-top:20px;border-collapse:collapse;}
td,th{border-bottom:1px solid #333;padding:8px;}
</style>
</head>
<body>

<div class="container">
<h2>ALBAY STEPS • Admin Panel</h2>

<h3>Bakiyeleri Gör</h3>
<table id="usersTable">
<tr><th>Kullanıcı</th><th>Bakiye (₺)</th></tr>
</table>
<button onclick="loadUsers()">Yenile</button>

<h3>Bakiye Ekle / Düş</h3>
<input type="text" id="email" placeholder="Telefon veya Email">
<input type="number" id="amount" placeholder="Örn: +20 veya -15">
<button onclick="updateBalance()">Uygula</button>

<h3>Çekim Talepleri</h3>
<table id="withdrawTable">
<tr><th>Kullanıcı</th><th>IBAN</th><th>Tutar</th></tr>
</table>
<button onclick="loadWithdraws()">Talepleri Yenile</button>

<button onclick="logout()">Çıkış Yap</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyKGnhEBtOwlRsuNbAWGP7OFU887akGiQs1jNyXU0IjymIAiu30kNdmhW1fjCxLIrnS/exec";

function loadUsers(){
  fetch(API_URL + "?all=1")
  .then(r=>r.json())
  .then(data=>{
    let table = document.getElementById("usersTable");
    table.innerHTML = "<tr><th>Kullanıcı</th><th>Bakiye (₺)</th></tr>";
    data.forEach(row=>{
      table.innerHTML += `<tr><td>${row.email}</td><td>${row.balance}</td></tr>`;
    });
  });
}

function updateBalance(){
  let email = document.getElementById("email").value;
  let amount = document.getElementById("amount").value;
  fetch(API_URL + `?admin=1&email=${email}&amount=${amount}`)
  .then(r=>r.text())
  .then(msg=>{ alert(msg); loadUsers(); });
}

function loadWithdraws(){
  fetch(API_URL + "?withdraws=1")
  .then(r=>r.json())
  .then(data=>{
    let table = document.getElementById("withdrawTable");
    table.innerHTML = "<tr><th>Kullanıcı</th><th>IBAN</th><th>Tutar</th></tr>";
    data.forEach(row=>{
      table.innerHTML += `<tr><td>${row.email}</td><td>${row.iban}</td><td>${row.amount} ₺</td></tr>`;
    });
  });
}

function logout(){
  localStorage.removeItem("admin");
  location.reload();
}

loadUsers();
loadWithdraws();
</script>

</body>
</html>
