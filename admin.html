<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin • ALBAY STEPS</title>
<script>const API_URL="https://script.google.com/macros/s/AKfycbxHcjw7HYAM6AgrpC7vF27oSeVqJo3TSngJDnS-ELblvvVNDq3ywTU0xqyRL-IG5bAY/exec";</script>
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
.wrap{max-width:720px;margin:20px auto;padding:16px}
h2{color:#e30613;margin:0 0 12px}
input,button{padding:10px;border:none;border-radius:8px;margin:6px}
button{background:#e30613;color:#fff;font-weight:700}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border-bottom:1px solid #222;padding:8px;text-align:left}
.row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
</style>
</head>
<body>
<div class="wrap">
  <h2>Admin Panel</h2>
  <div class="row">
    <button onclick="loadUsers()">Kullanıcıları Yükle</button>
    <input id="aEmail" placeholder="email/telefon">
    <input id="aAmt" type="number" placeholder="+50 / -20">
    <button onclick="upd()">Bakiye Uygula</button>
    <button onclick="loadWithdraws()">Çekim Talepleri</button>
  </div>
  <h3>Kullanıcılar</h3>
  <table id="users"><tr><th>Email</th><th>Bakiye (₺)</th></tr></table>
  <h3>Çekim Talepleri</h3>
  <table id="wd"><tr><th>Tarih</th><th>Email</th><th>IBAN</th><th>Tutar</th><th>Durum</th></tr></table>
  <div class="row"><button onclick="location.href='panel.html'">Panele Dön</button></div>
</div>
<script>
async function loadUsers(){
  const r=await fetch(API_URL+'?all=1'); const data=await r.json();
  const t=document.getElementById('users'); t.innerHTML='<tr><th>Email</th><th>Bakiye (₺)</th></tr>';
  data.forEach(x=>t.innerHTML+=`<tr><td>${x.email}</td><td>${x.balance}</td></tr>`);
}
async function upd(){
  const e=(document.getElementById('aEmail').value||'').trim();
  const a=Number(document.getElementById('aAmt').value||0);
  if(!e||!a) return alert('Email ve miktar gerekli');
  const r=await fetch(`${API_URL}?admin=1&email=${encodeURIComponent(e)}&amount=${encodeURIComponent(a)}`);
  alert('Yeni bakiye: '+await r.text()); loadUsers();
}
async function loadWithdraws(){
  const r=await fetch(API_URL+'?withdraws=1'); const data=await r.json();
  const t=document.getElementById('wd'); t.innerHTML='<tr><th>Tarih</th><th>Email</th><th>IBAN</th><th>Tutar</th><th>Durum</th></tr>';
  data.forEach(x=>t.innerHTML+=`<tr><td>${x.timestamp}</td><td>${x.email}</td><td>${x.iban}</td><td>${x.amount}</td><td>${x.status}</td></tr>`);
}
</script>
</body>
</html>
